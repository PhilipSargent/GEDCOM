Bugs list now split into "Faults" and "Wish list". Fixed faults
removed to file BugsFixed.

========= Features ==========

Things which are a consequence of doing things "well" which have
potentially unforseen consequences.

!Family produces GEDCOM which conforms most closely to spec. version 5.3,
with the sole addition of the CREM tag (introduced at 5.4). However, because
!Family is careful to preserve any content of an incoming GEDCOM which it
doesn't understand, its output could include GEDCOM conforming to other
GEDCOM specs. This could be seen as a fault, but on the other hand, seems a
much better idea than, for example, Personal Ancestral file (4.04) which
seems only to understand GEDCOM 4 and 5.5, flagging things which are
perfectly valid 5.3 GEDCOM as faults *and throwing away the information*.

========= FAULTS ==========

New bugs since code sent for Beta test:

A GEDCOM from Family Tree Maker for Windows has things like
1 NOTE @NI06038@
...
0 @NI06038@ NOTE
1 CONC Data Source:
1 CONT   ...
this seems to utterly break !Family when it opens the Notes window, though
closing that window and hitting F12 then <return> to refresh the desktop
seems to cure it. My surmise is that the xref is being converted to a 32-bit
pointer and this is then being sent to the Notes window as VDU codes, which
leaves the screen in a silly state. I was not aware that you were allowed to
use NOTE like this - I'll have to investigate. I wonder what X!Family makes
of it... I suspect that it will be OK, because it doesn't reuse that bit of
structure.

Personal Ancestral File whinges that TIME is an unexpected tag in events like
BIRTh and DEATh - it should be a subtag of DATE, not at the same level. This
will not only need to be fixed in !Family, but will also require a tool to
fix GEDCOM files. Be aware that the TIME tag may not directly follow the DATE
tag in an event structure generated by !Family, so its quite hard to do this
with something like !Edit... Potentially you might have a TIME tag without
a DATE tag, and this would require creating an empty DATE tag.

Even if the GEDCOM version in the header is set to 5.3, Personal
Ancestral File whinges about the PLACe->SITE/CEME->PLOT structures
which were definitely specififed that way in 5.3 - this is a fault in
P.A.F., but one which we should probably try to work round by eliminating
those tags in favour of the rather less structured format of the 5.5
standard. It would be useful to use the FORM tag to define a structure
for data within the PLAC tag which would enable us to keep to the
current template format. However whilst CEME is equivalent to SITE,
PLOT is unique to the PLAC structure for BURI. There is also nothing
to stop the user typing the FORM delimiter (a comma) into a PLOT or
SITE field, which will then confuse things.

Adding a new person unconnected with the displayed tree doesn't get
you to a display with that person on, which is confusing. However,
my first fix for this was in error, as it made *any* new person
added into the current person, which is not wanted when adding new
children. Code reverted, original problem remains.

Since reverting, when opening Edit window from the => child menu
item, the "details" button never activates, although it still
behaves as it should when opened from the -> Edit menu item. This
is exactly what we coded - Details cannot work until you create
the person, so you need to add a name and hit "Update". Clearly
this is not obvious, since you forgot it within a day !!!

HTML index file title "Person Index" is not internationalised

Internationalisation should map Acorn's Country/Territory number into a
 string code like "en-gb", "fr" etc. and use this for the messages file
 name, as it is far more transparent and these will be the file names
 to use in a portable implementation. For Linux there are defined ways
 to decide what language to use, but for RISC OS, to use the same names,
 there should be a global file to map from country/territory to ISO 639
 code, which should be available to other applications too. This should be
 overridable by some environment variable, so we can support additional
 languages which would not be determined by country/territory. Perhaps
 the global mapping file could also be used to specify fall-back languages
 to use in the absence of the specified one. [The Linux implementation
 leaves language choice as configurable from a menu, so you can change
 language dynamically, and is intended to store the last language choice
 when "Save Choices" is used. The start up language is then determined
 from the choices file, overridable by an environment variable, in turn
 overridable by a command line option. Some system wide language choice
 is only an ultimate fall-back when there is no choices file...]

New bugs identified since mailing Denis Howe:

Cross-references outside the file should contain a colon - this should be
used to decide whether to "Ignore silently", rather than "whether starts
I, F or <n>" [On the other hand, this then makes it a pain if/when you
merge the two files, if you are building the source record file separately
purely because !Family doesn't deal with source records - I am inclined to
leave the code unchanged, or perhaps make an xref containing a colon
behave as "ignore silently" whatever the option set - but then you need
to add code to generate a soft error if the user tries to follow an
external link, and similar code to put something on the display if, for
example, an INDI in the file has a FAMC pointer to a family object not
in the loaded file. Could get quite nasty...]

Removing a date (of birth, as it manifested) caused a PROCfree not heap
4319 (presumably freeing the string). Afterwards, the saved file had a
1 BIRT, with no following 2 DATE or any other subobject. Continuing to
use the program soon caused a PROCdisplayindi error, at which point it
was painlessly terminated. This occurred again in 2.23, with a death.
(Mind you, at 2.18, doing this consistently crashed the program, but
clearly the fix has not been perfect).

Choosing to display spouse dates causes program to bomb by passing a
zero pointer to FNdate (this didn't used to happen). However, defatalising
this error by causing the function to return an error string (rather than
raising an error) doesn't result in any displayed error strings where dates
should be, so we must assume that the function was being called in error for
something which wasn't intended to be displayed anyway. Hmmmm. I think this
is caused by a problem in the GEDCOM, rather than in the program, but we
ought to be a bit more resilient to broken GEDCOM - at least report the
problem in the file/structure before bombing out. Build in more consistency
checking code...

FNdate is now called with a debugging identifier (nominally the line number
of the caller) as a second parameter - although the fault has not recurred,
this debugging code is still there at the moment (oh, for conditional
compilation :-)

The ISOdate library does not do the job very well for dates with a year
ambiguity caused by a calendar change (typically first quarter of years
before 1752 in England/USA). So that what started as 1750.02 ends up
displayed as FEB 1750, then 1750 FEB. Changes made 2000-04-13 should have
fixed this, but it is not yet confirmed that the fault is fully cured. The
further bug that years starting with a "9" locked the program up has been
fixed :-)

Bugs in !Family 2.18 before any new code
========================================

"Older" should be greyed for sibling who is already oldest, or only child

"Older" currently works on a child when the siblings are not shown on the
tree (ie. the child is on screen as a spouse). I'm not sure that this should
be the case - it is certainly very confusing in the user interface...

In an empty tree, choose => Goto and type a name, this creating a new
person. The person is green, for gender unknown. Now menu on the person
and choose => Child. The person becomes male. Seems to happen for any
ungendered person. Doesn't always seem to happen if you use Ctrl/C. Ah,
perhaps it does, but doesn't force a redraw... This is definitely not
a new bug - it is a function of PROCMaleFemale. It is also probably not a
bug, because GEDCOM won't support a parent that isn't specified with
either a HUSB or WIFE tag in the FAM object. So we are forced to choose
a gender, and the default is male. This is actually a bug in GEDCOM, since
it is perfectly possible to know that a person existed and had a child,
without necessarily knowing their gender (indeed, in theory its possible
to know both parents without knowing which one is which). GEDCOM can't
represent either of these situations.

Bugs introduced with new code
=============================

If you drag a GEDCOM file to the main window it is merged, rather than
becoming the tree being edited. This results in two headers in the file,
even if the main window was "empty" ie. just after a reset. There should
obviously only be one header ... However, there is indeed only one trailer.
Not sure if this was the same in 2.18 - I have made changes here.

If you hit "Current" in the Marry window, the current person is entered
even if he/she is the wrong gender for the marriage. Program allows you
to marry two people of the same gender and the result is definitely bad
news. [partly a bug in 2.18 already, though now rather more obvious]

If we merge a tree, we expose ourselves to a clash of cross-reference ids,
which we should trap, and refuse to merge the tree (though by the time we
spot it, it will be too late). There is a (very Noddy) support program to
renumber a GEDCOM file from a given starting F and I number (the maximum
ones used are reported by !Family in the statistics window) [Linux version
will only support merging trees when both are in memory in separate
instances of the main window - we will ask which of the trees to renumber.
What merging really needs is a way of identifying people in two trees as
being identical, and then resolving any clashes in their info]

In common with some other programs (eg. GED2WWW) we use the LVG
tag to mark people as living. But since this isn't defined in GEDCOM 5.3,
I probably haven't got the format right. In fact, since I use
1 LVG <date exact>
I can almost guarantee that it is wrong. Much more likely is something
like
1 LVG TRUE|FALSE
2 DATE <date exact>
However, I see no point in coding for this without the proper info...
 need more example GEDCOM data for doing QA
GED2WWW seems to simply have 1 LVG <anything>
as the flag - it is possible to indicate that someone is dead by
including simply
1 DEAT
2 DATE BEF <today>
but the converse of using the DEAT tag with
2 DATE AFT <today>
does not work, as it indicates that the person *is* dead to anyone
reading the file subsequently.

!Help not updated for new features - temptation is to make this an
html edifice. [Interactive help *is* updated] [HTML help will certainly
be the route for the Linux/FLTK/Windows versions]

It is far from clear that the output index file in the save-as-html
dialogue gets closed properly when the save fails (eg. more than 77
individuals in a Filecore dir). I think in these cases the Web pages
dbox isn't closed either - we could at the very least make the cancel
button ensure that the index file is closed (and probably make the
cancel, OK and end-of-drag cause a close before restarting).

=================== WISHLIST ==================

Remove restriction requiring everyone to have a unique name. Temporary
help would be to check whenever a name is edited that there is not a
clash with another name.

Remove restriction on number of people in completions window (using
linked list).

Do not create new person when an unknown name is entered in the Goto
dbox - ask user first

Standard report, family groups report, Ancestor trees and of course, the main
display window all try to add birth and death dates for each person. However,
in many cases we don't have a date of birth or death, but we *do* have a date
for christening, baptism, cremation or burial. We should attempt, if no birth
date, to try christening (flag this CHR) and then baptism (flag BAPM) as
substitutes to give some indication. Similarly for death, we should try first
cremation (CREM) and then burial (BURI). [dates for all these events go into
the web pages, if known. Cremation was added 1999.12.08, having been omitted
when the CREM tag was added to the rest of the code].

It would similarly be useful to use substitute dates in the completions
window. Here space is at a premium, but substitute dates could be
distinguished by colour.

The completions window shows dates like "BEF 1916" as just the year (as
does the main display window if "show year only" is chosen), which is pretty
misleading. Mind you, if the date was actually "BEF 12 DEC 1916" and we used
"BEF 1916" that would also be not quite right... see comments above about
distinguishing dates by colour in this window

MaxGen% is a structural limit on the number of generations - we need
 a dynamically configurable limit on the number of generations actually
 shown on the display, saved in Drawfiles, or included in ancestor trees.

Make !Family a multi-document editor. Merge two trees in memory.

Be able to interpret the dates :-) Difficult because indeterminate. GEDCOM at
5.5 is talking about a method for representing dates unambiguously as a
number of days after an arbitrary starting point. This would no doubt help,
but as the proposals aren't fixed, it is currently merely a frustration.

Write a time-line report generator - this requires we can actually
interpret the dates, rather than just convert them. This needs that we
process calendar escape sequences (at least @#DJULIAN@ and @#DGREGORIAN@).
We should have routines to convert internally into "Julian Day" as used
by astonomers (and by GeneWeb).

It would be worth while to ensure that we record both "date as presented in
the source" and "interpreted date as we understand it" - the former allows
new researchers to evaluate the evidence, whilst the latter would be our
interpretation adapted for use in time lines etc. Ambiguities arise from
uncertainty which calendar was being used, and previous researchers' failure
to understand the meaning of ambiguous years when representing dates in
secondary sources.

If we are interpreting dates, we could make intelligent deductions about
whether people might be living without recourse to the LVG tag (which is
not part of GEDCOM at version 5.5). We could also trap obvious blunders
like death-before-birth, birth not during mother's lifetime or, slightly
harder, setting a mother's death earlier than the birth of her youngest
offspring ...

Misc options could have a set of options for the newline delimiter used in
saved GEDCOM files and all the reports (Report, Ancestors, Family Groups and
web pages). Default would be Unix/RISC OS 0x0a, with options to use 0x0d or
0x0d+0x0a. We should ensure that we cope with any of these on input (!Family
already does, as per GEDCOM 5.3 spec.)

Code to deal with sources, user references (REFN) and the user-defined
tag _HREF, which can be used to include source scans or existing web
pages when building the web hierarchy. This is slightly complicated
because we would need to include the SCHEMA object in the header iff an
_HREF tag was used anywhere, viz.:

1 SCHEMA
2 SOUR
3 _HREF
4 LABL HYPERTEXT_REFERENCE
4 DEFN Hypertext Reference (absolute or relative to GEDCOM file)
4 ISA REFN

You might care to note that the SCHEMA tag for defining new (user) tags
has been removed at GEDCOM 5.4. This effectively means that your software
needs to do everything like this via its own keywords in NOTE objects.

Code to deal with escape to auxiliary processing (like photos, sound,
video). This would basically just Filer_Run the image/sound/video file,
but would need to be supported by a Person menu item
Multi-media=> Photo       possibly with further submenus if more than one
              Sound       external file was linked to a given person
              Video       Items greyed if no such links
These items would be fairly readily included in the web edifice

No dbox for engaged - probably just use the Date window ?
No dbox for MARL - this is rare enough that we should probably just use
GEDCOM editing. Or perhaps you could have a generic Event dbox in which
you specify (a) whether it applies to the FAM or the INDI and (b) the
tag of the object to be created. There are many other events (esp.
relevant to LDS or Jewish families, for example, but also things like
legal separation, church confirmation, graduation ...) which we don't
deal with in !Family.

No way to add (or display) notes to FAM objects. In theory we should be
able to add notes to other objects too, but there is an obvious need in
the case of FAM.

WishList items done:
====================

Build an ancestor tree report generator (but only in text)
Integrate the Family Group report into the main program (but is not sorted
 on husband's name, then wife's name, then marriage date, as ideal).
Completions window to show dates birth-death to aid identification
Incorporate a GED->html generator

